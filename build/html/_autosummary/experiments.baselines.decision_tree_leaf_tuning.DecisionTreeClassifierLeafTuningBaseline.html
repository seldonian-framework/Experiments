<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline &#8212; Seldonian Experiments alpha documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=bc8d421b" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=3d6c492d"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="experiments.baselines.diabetes_US_baseline" href="experiments.baselines.diabetes_US_baseline.html" />
    <link rel="prev" title="experiments.baselines.decision_tree_leaf_tuning" href="experiments.baselines.decision_tree_leaf_tuning.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="experiments-baselines-decision-tree-leaf-tuning-decisiontreeclassifierleaftuningbaseline">
<h1>experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline<a class="headerlink" href="#experiments-baselines-decision-tree-leaf-tuning-decisiontreeclassifierleaftuningbaseline" title="Permalink to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DecisionTreeClassifierLeafTuningBaseline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">primary_objective_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_regime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adam_kwargs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">SeldonianDecisionTree</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">primary_objective_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_regime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adam_kwargs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements a decision classifier with leaf node tuning
as a baseline for binary classification tasks</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>primary_objective</strong> – The primary objective function to be minimized 
during the leaf tuning process.</p></li>
<li><p><strong>sub_regime</strong> – Sub category of ML problem, e.g., “classification”</p></li>
<li><p><strong>adam_kwargs</strong> – Keyword arguments to pass to the adam optimizer</p></li>
<li><p><strong>dt_kwargs</strong> – Any keyword arguments that scikit-learn’s
DecisionTreeClassifier takes.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.__repr__">
<span class="sig-name descname"><span class="pre">__repr__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.__repr__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return repr(self).</p>
</dd></dl>

<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.adam">
<span class="sig-name descname"><span class="pre">adam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta_init</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.adam" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform gradient descent with adam optimizer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>theta_init</strong> – The initial weights to begin gradient descent</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>best_theta, the optimal weights that minimize the primary objective function</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper around SKLearn’s fit() method. Returns the leaf node probabilities
of SKLearn’s built tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> (<em>numpy ndarray</em>) – Features</p></li>
<li><p><strong>labels</strong> (<em>1D numpy array</em>) – Labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Leaf node probabilities (of predicting the positive class only),
ordered from left to right</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.forward_pass">
<span class="sig-name descname"><span class="pre">forward_pass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.forward_pass" title="Permalink to this definition">¶</a></dt>
<dd><p>Do a forward pass through the sklearn model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>numpy ndarray</em>) – model features</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>probs_pos_class: the vector of probabilities, 
leaf_nodes_hit: the ids of the leaf nodes that were</p>
<blockquote>
<div><p>hit by each sample. These are needed for computing the Jacobian</p>
</div></blockquote>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.get_jacobian">
<span class="sig-name descname"><span class="pre">get_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ans</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.get_jacobian" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Jacobian d(forward_pass)_i/dtheta_j,
where i run over datapoints and j run over model parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ans</strong> – The result of the forward pass function evaluated on theta and X</p></li>
<li><p><strong>theta</strong> – The weight vector, which isn’t used in this method</p></li>
<li><p><strong>X</strong> – The features</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.get_leaf_node_probs">
<span class="sig-name descname"><span class="pre">get_leaf_node_probs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.get_leaf_node_probs" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the leaf node probabilities from the current tree from left to right</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Call the autograd primitive (a workaround since our forward pass involves an external library)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>numpy ndarray</em>) – model weights (not probabilities)</p></li>
<li><p><strong>X</strong> (<em>numpy ndarray</em>) – model features</p></li>
</ul>
</dd>
<dt class="field-even">Return pred<span class="colon">:</span></dt>
<dd class="field-even"><p>model predictions</p>
</dd>
<dt class="field-odd">Rtype pred<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy ndarray same shape as labels</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.set_leaf_node_values">
<span class="sig-name descname"><span class="pre">set_leaf_node_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">probs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.set_leaf_node_values" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Update the leaf node probabilities </dt><dd><p>(actually the numbers in each label)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>probs</strong> – The vector of probabilities to set on the
leaf nodes from left to right</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate a new model instance and train (fit) 
it to the training data, X,Y. Then run Adam gradient descent 
on the leaf node probabilities.
:param X: features
:type X: 2D np.ndarray 
:param Y: labels
:type Y: 1D np.ndarray</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.wrapped_primary_objective">
<span class="sig-name descname"><span class="pre">wrapped_primary_objective</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.wrapped_primary_objective" title="Permalink to this definition">¶</a></dt>
<dd><p>The first argument of primary_objective_fn is model,
which is used to get the predictions via .predict(). We
want to use the current model’s predict() method (inherited) for this, 
so we use self for first arg.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>theta</strong> – Model weights</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The primary objective function evaluated with these theta weights</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Seldonian Experiments</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="experiments.html">experiments</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="experiments.base_example.html">experiments.base_example</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="experiments.baselines.html">experiments.baselines</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="experiments.baselines.decision_tree.html">experiments.baselines.decision_tree</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="experiments.baselines.decision_tree_leaf_tuning.html">experiments.baselines.decision_tree_leaf_tuning</a><ul class="current">
<li class="toctree-l5 current"><a class="current reference internal" href="#">experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline"><code class="docutils literal notranslate"><span class="pre">DecisionTreeClassifierLeafTuningBaseline</span></code></a><ul>
<li class="toctree-l7"><a class="reference internal" href="#experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.__init__"><code class="docutils literal notranslate"><span class="pre">DecisionTreeClassifierLeafTuningBaseline.__init__()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.__repr__"><code class="docutils literal notranslate"><span class="pre">DecisionTreeClassifierLeafTuningBaseline.__repr__()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.adam"><code class="docutils literal notranslate"><span class="pre">DecisionTreeClassifierLeafTuningBaseline.adam()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.fit"><code class="docutils literal notranslate"><span class="pre">DecisionTreeClassifierLeafTuningBaseline.fit()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.forward_pass"><code class="docutils literal notranslate"><span class="pre">DecisionTreeClassifierLeafTuningBaseline.forward_pass()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.get_jacobian"><code class="docutils literal notranslate"><span class="pre">DecisionTreeClassifierLeafTuningBaseline.get_jacobian()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.get_leaf_node_probs"><code class="docutils literal notranslate"><span class="pre">DecisionTreeClassifierLeafTuningBaseline.get_leaf_node_probs()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.predict"><code class="docutils literal notranslate"><span class="pre">DecisionTreeClassifierLeafTuningBaseline.predict()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.set_leaf_node_values"><code class="docutils literal notranslate"><span class="pre">DecisionTreeClassifierLeafTuningBaseline.set_leaf_node_values()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.train"><code class="docutils literal notranslate"><span class="pre">DecisionTreeClassifierLeafTuningBaseline.train()</span></code></a></li>
<li class="toctree-l7"><a class="reference internal" href="#experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.wrapped_primary_objective"><code class="docutils literal notranslate"><span class="pre">DecisionTreeClassifierLeafTuningBaseline.wrapped_primary_objective()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="experiments.baselines.diabetes_US_baseline.html">experiments.baselines.diabetes_US_baseline</a></li>
<li class="toctree-l4"><a class="reference internal" href="experiments.baselines.fitted_Q.html">experiments.baselines.fitted_Q</a></li>
<li class="toctree-l4"><a class="reference internal" href="experiments.baselines.linear_regression.html">experiments.baselines.linear_regression</a></li>
<li class="toctree-l4"><a class="reference internal" href="experiments.baselines.logistic_regression.html">experiments.baselines.logistic_regression</a></li>
<li class="toctree-l4"><a class="reference internal" href="experiments.baselines.random_classifiers.html">experiments.baselines.random_classifiers</a></li>
<li class="toctree-l4"><a class="reference internal" href="experiments.baselines.random_forest.html">experiments.baselines.random_forest</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="experiments.experiment_utils.html">experiments.experiment_utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="experiments.experiments.html">experiments.experiments</a></li>
<li class="toctree-l3"><a class="reference internal" href="experiments.generate_plots.html">experiments.generate_plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="experiments.headless_example.html">experiments.headless_example</a></li>
<li class="toctree-l3"><a class="reference internal" href="experiments.perf_eval_funcs.html">experiments.perf_eval_funcs</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../api.html">API</a><ul>
  <li><a href="experiments.html">experiments</a><ul>
  <li><a href="experiments.baselines.html">experiments.baselines</a><ul>
  <li><a href="experiments.baselines.decision_tree_leaf_tuning.html">experiments.baselines.decision_tree_leaf_tuning</a><ul>
      <li>Previous: <a href="experiments.baselines.decision_tree_leaf_tuning.html" title="previous chapter">experiments.baselines.decision_tree_leaf_tuning</a></li>
      <li>Next: <a href="experiments.baselines.diabetes_US_baseline.html" title="next chapter">experiments.baselines.diabetes_US_baseline</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, University of Massachusetts.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/_autosummary/experiments.baselines.decision_tree_leaf_tuning.DecisionTreeClassifierLeafTuningBaseline.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>